<script>
  // 🔹 Function to fetch and verify
  async function verifyCertificate(certId) {
    const resultBox = document.getElementById("result");
    const inputCard = document.getElementById("inputCard");

    if (!certId) {
      resultBox.innerHTML = "❌ Please enter a Certificate ID.";
      return;
    }

    try {
      // ✅ Add cache-busting parameter
      const response = await fetch("certificates.json?v=" + Date.now());
      const data = await response.json();
      const cert = data.find(c => c.id === certId);

      if (cert) {
        // Hide input card if verified via link
        if (window.location.search.includes("certId")) {
          inputCard.style.display = "none";
        }

        resultBox.innerHTML = `
  <div style="
    max-width: 500px;
    margin: 50px auto;
    padding: 35px 30px;
    border-radius: 25px;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 10px 10px 30px rgba(0,0,0,0.2), -10px -10px 30px rgba(255,255,255,0.2);
    text-align: left;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #004d40;
    transition: transform 0.5s ease, box-shadow 0.5s ease;
  ">
    <h2 style="
      margin-bottom: 25px; 
      font-size: 2em; 
      letter-spacing: 1px; 
      border-bottom: 2px solid rgba(0, 77, 64, 0.4); 
      padding-bottom: 10px;
    ">Certificate Verification</h2>
    <p style="margin: 12px 0;"><strong>Full Name:</strong> ${cert.name} <span style="color:green; font-weight:bold;">VERIFIED</span></p>
    <p style="margin: 12px 0;"><strong>Course Title:</strong> ${cert.course}</p>
    <p style="margin: 12px 0;"><strong>Certification Status:</strong> ${cert.status}</p>
    <p style="margin: 12px 0;"><strong>Date of Issue:</strong> ${cert.issueDate}</p>
  </div>
`;
      } else {
        resultBox.innerHTML = "❌ Invalid Certificate ID";
      }
    } catch (error) {
      resultBox.innerHTML = "⚠️ Error loading certificate data.";
    }
  }

  // Manual verify button
  function manualVerify() {
    const certId = document.getElementById("certId").value.trim();
    verifyCertificate(certId);
  }

  // 🔹 Auto check when certId is in URL
  window.onload = () => {
    const params = new URLSearchParams(window.location.search);
    const certId = params.get("certId");
    if (certId) {
      verifyCertificate(certId);
    }
  };
</script>
